/*

 * DC jQuery Drill Down Menu - jQuery drill down ipod menu
 * Copyright (c) 2011 Design Chemical
 *
 * Dual licensed under the MIT and GPL licenses:
 * 	http://www.opensource.org/licenses/mit-license.php
 * 	http://www.gnu.org/licenses/gpl.html
 *
 */(function(e){e.fn.dcDrilldown=function(t){function r(t){var n=undefined;e(t).each(function(){var t=parseInt(e("> li",this).length);e(this).attr("rel",t);if(n===undefined||n<t)n=t});return n}function i(t){var n=undefined;e(t).each(function(){var t=parseInt(e(this).parents("li").length);if(n===undefined||n<t)n=t});return n}function s(t,r){var i=e.cookie(t);if(i!=null){var s=i.split(",");e.each(s,function(t,i){var s=e("li:eq("+i+")",r);e("> a",s).addClass(n.classActive)})}}function o(t,r,i){var s=e("."+n.classHeader,r),o=e("h3",s).html(),u=e("> a",t).html();if(n.linkType=="breadcrumb"){e("ul",s).length||e(s).prepend("<ul></ul>");o==n.defaultText?e("ul",s).append('<li><a href="#" class="first">'+n.resetText+"</a></li>"):e("ul",s).append('<li><a href="#">'+o+"</a></li>")}n.linkType=="backlink"&&(e("a",s).length?e(".link-back",s).html(o):e(s).prepend('<a href="#" class="link-back">'+o+"</a>"));n.linkType=="link"&&(e("a",s).length||e(s).prepend('<ul><li><a href="#" class="first">'+n.resetText+"</a></li></ul>"));a(s,u);var f=e("> a",t);e(f).addClass(n.classActive);e("> ul li",t).show();e("> ul",t).animate({"margin-right":0},n.speed);var c=e(t).siblings();e(c).hide();n.linkType!="link"&&e(f).hide();if(n.saveState==1){var h=e(r).attr("id");l(h,i)}}function u(t,r,i){var s=e("."+n.classHeader,i),o=e("> a",t),u=e("."+n.classActive,i).length,a=e(o).index("."+n.classActive,i),f=e(r).outerWidth(!0);e("ul",t).css("margin-right",-f+"px");e(o).addClass(n.classActive);e("> ul li",t).show();e("a",t).show();var l=e("> a",t).html();e("h3",s).html(l);if(n.linkType=="breadcrumb"){var c=a-1;e("a:gt("+a+")",s).remove()}}function a(t,r){n.includeHdr==1&&(e("h3",t).length?e("h3",t).html(r):e(t).append("<"+n.headerTag+">"+r+"</"+n.headerTag+">"))}function f(t,r){var i=e("."+n.classHeader,r);e("ul",i).remove();e("a",i).remove();e("li",t).show();e("a",t).show();var s=e(t).outerWidth(!0);if(n.linkType=="link")if(e("a."+n.classActive+":last",t).parent("li").length){var u=e("a."+n.classActive+":last",t).parent("li");e("ul",u).css("margin-right",-s+"px")}else e("ul",t).css("margin-right",-s+"px");else e("ul",t).css("margin-right",-s+"px");a(i,n.defaultText);if(n.saveState==1){var f=e(r).attr("id");l(f,t)}e("a."+n.classActive,t).each(function(n){var i=e(this).parent("li").stop();o(i,r,t)})}function l(t,r){var i=[];e("a."+n.classActive,r).each(function(t){var n=e(this).parent("li"),s=e("li",r).index(n);i.push(s)});e.cookie(t,i,{path:"/"})}var n={classWrapper:"dd-wrapper",classMenu:"dd-menu",classParent:"dd-parent",classParentLink:"dd-parent-a",classActive:"active",classHeader:"dd-header",eventType:"click",hoverDelay:300,speed:"slow",saveState:!0,showCount:!0,classCount:"dd-count",classIcon:"dd-icon",linkType:"backlink",resetText:"All",headerTag:"h3",defaultText:"Select Option",includeHdr:!0},t=e.extend(n,t);return this.each(function(t){function m(){$arrow='<span class="'+n.classIcon+'"></span>';e(u).before(d);var t=e(u).outerWidth();t+="px";var s=e("li",u).outerHeight(!0),o=e("ul",u),a=r(o),f=e(o+'[rel="'+a+'"]'),c=i(f);n.linkType=="link"?menuHeight=s*(a+c):menuHeight=s*a;e(u).css({height:menuHeight+"px",width:t});e("li",u).each(function(){e(this).css({width:t});e("ul",this).css({width:t,marginRight:"-"+t,marginTop:"0"});if(e("> ul",this).length){e(this).addClass(n.classParent);e("> a",this).addClass(n.classParentLink).append($arrow);if(n.showCount==1){var r=e("a:not(."+n.classParentLink+")",this),i=parseInt(e(r).length);getCount=i;e("> a",this).append(' <span class="'+n.classCount+'">('+getCount+")</span>")}}});e("ul",l).each(function(){e("li:last",this).addClass("last")});e("> ul > li:last",l).addClass("last");n.linkType=="link"&&e(o).css("top",s+"px")}var u=this;e(u).addClass(n.classMenu);var a='<div class="'+n.classWrapper+'" />';e(u).wrap(a);var l=e(u).parent(),c=e(l).index("."+n.classWrapper),h=n.classHeader+"-"+c,p=n.classWrapper+"-"+c;e(l).attr("id",p);var d='<div id="'+h+'" class="'+n.classHeader+'"></div>';m();if(n.saveState==1){var v=n.classWrapper+"-"+c;s(v,u)}f(u,l);e("li a",u).click(function(t){$link=this;$activeLi=e(this).parent("li").stop();$siblingsLi=e($activeLi).siblings();if(e("> ul",$activeLi).length)if(e($link).hasClass(n.classActive)){e("ul a",$activeLi).removeClass(n.classActive);f(u,l)}else o($activeLi,l,u);e(this).next("ul").length>0&&t.preventDefault()});e("#"+h+" a").live("click",function(t){if(e(this).hasClass("link-back")){r=e("#"+p+" ."+n.classParentLink+".active").length;r-=2;e("a."+n.classActive+":last",u).removeClass(n.classActive)}else{var r=parseInt(e(this).index("#"+h+" a"));if(r==0)e("a",u).removeClass(n.classActive);else{r-=1;e("a."+n.classActive+":gt("+r+")",u).removeClass(n.classActive)}}f(u,l);t.preventDefault()})})}})(jQuery);